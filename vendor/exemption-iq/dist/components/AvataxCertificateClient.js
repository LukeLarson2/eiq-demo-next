"use client";import{useEffect as G,useState as a,useRef as _}from"react";import t from"react";const r={container:{width:"100%",height:"35rem",position:"relative",overflowY:"auto"},loadingOverlay:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.9)",zIndex:10},spinner:{height:"3rem",width:"3rem",borderRadius:"9999px",borderBottom:"2px solid #3b82f6",animation:"eiq-spin 1s linear infinite"},loadingText:{marginTop:"1rem",color:"#4b5563",textAlign:"center"},formContainer:{width:"100%",height:"100%"},closeBtnContainer:{position:"absolute",top:"0.5rem",right:"0.5rem",display:"flex",gap:"0.5rem",zIndex:50},closeBtn:{padding:"0.5rem 1rem",backgroundColor:"white",color:"#1f2937",border:"1px solid #e5e7eb",borderRadius:"0.375rem",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",cursor:"pointer",transition:"background-color 0.2s ease-in-out"},closeBtnHover:{backgroundColor:"#f3f4f6"},errorBox:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"0.5rem",padding:"1rem",color:"#b91c1c",fontWeight:500},keyframes:`
    @keyframes eiq-spin {
      to {
        transform: rotate(360deg);
      }
    }
  `};function A({token:u,state:o,showDownload:d=!1,manualValidation:y=!0,onCertificateComplete:m,onClose:h,customerInfo:i,shouldPrefillState:b=!0,mode:C,onComplete:n,customerCode:w,environment:v="production"}){const[x,l]=a(null),[B,s]=a(!0),[g,z]=a(!1),[E,S]=a(!1),c=_(null),k=()=>{window.GenCert&&(window.GenCert.hide(),h())};return G(()=>{if(typeof window<"u"&&!document.getElementById("eiq-spin-style")){const e=document.createElement("style");e.id="eiq-spin-style",e.textContent=r.keyframes,document.head.appendChild(e)}if(g)return;const f=(()=>{const e=document.createElement("script");return e.src=v==="production"?"https://app.certcapture.com/gencert2/js":"https://sbx.certcapture.com/gencert2/js",e.crossOrigin="anonymous",e.onload=()=>{if(c.current&&window.GenCert)try{window.GenCert.init(c.current,{token:u,customer_number:w,ship_zone:C==="renew"&&b?o:"",preview:d,show_files:d,submit_to_stack:y,onCertSuccess:()=>{if(S(!0),window.GenCert.certificateIds?.length){const p=window.GenCert.certificateIds[0];m(p),n?.(!0)}else n?.(!1)}}),i&&C==="renew"&&window.GenCert.setCustomerData({name:i.name,address1:i.addressLine1,address2:i.addressLine2,city:i.city,zip:i.postalCode,phone:i.phoneNumber,fax:i.faxNumber,email:i.emailAddress,state:o}),window.GenCert.setShipZone(o),window.GenCert.show(),s(!1),z(!0)}catch(p){console.error("Error initializing certificate form:",p),l("Failed to initialize the tax exemption certificate form."),s(!1),n?.(!1)}else l("The tax exemption certificate form could not be loaded."),s(!1),n?.(!1)},e.onerror=()=>{console.error("Failed to load certificate widget script."),l("Failed to load the tax exemption certificate system."),s(!1),n?.(!1)},document.body.appendChild(e),e})();return()=>{f&&document.body.contains(f)&&document.body.removeChild(f),document.querySelectorAll("style").forEach(e=>{e.textContent?.includes("form_container iframe")&&e.remove()})}},[u,o,d,g,m,i]),x?t.createElement("div",{style:r.container},t.createElement("div",{style:r.errorBox},t.createElement("p",null,"Error: ",x))):t.createElement("div",{style:r.container},B&&t.createElement("div",{style:r.loadingOverlay},t.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},t.createElement("div",{style:r.spinner}),t.createElement("p",{style:r.loadingText},"Loading tax exemption certificate form..."))),t.createElement("div",{ref:c,id:"form_container",style:r.formContainer,"aria-label":"Tax Exemption Certificate Form",role:"dialog"}),E&&t.createElement("div",{style:r.closeBtnContainer},t.createElement("button",{onClick:k,style:r.closeBtn},"Close Certificate")))}export{A as default};
